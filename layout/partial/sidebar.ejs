<div class="sidebar-section">
  <h3>About</h3>
  <p><%= config.description || 'Just a dumb journal.' %></p>
</div>
<% if (has_social_buttons()) { %>
<div class="sidebar-section social-buttons">
  <%- social_buttons() %>
</div>
<% } %>
<div class="sidebar-section">
  <h3>Recent Posts</h3>
  <ul>
    <% site.posts.sort('date', -1).limit(5).forEach(function(post) { %>
    <li>
      <a href="<%= url_for(post.path) %>"><%= post.title %></a>
      <% if (post.encrypted) { %>
      <%- partial('partial/lock') %>
      <% } %>
    </li>
    <% }) %>
  </ul>
</div>
<%
var sidebarCfg = theme.sidebar || {},
  rpCfg = sidebarCfg.recent_projects || {},
  rpEnabled = rpCfg.enabled !== false,
  rpLimit = rpCfg.limit || 5,
  recentProjects = (rpEnabled && typeof recent_projects === 'function') ? recent_projects(rpLimit) : [];
%>
<% if (rpEnabled && recentProjects.length) { %>
<div class="sidebar-section">
  <h3>Recent Projects</h3>
  <ul>
    <% recentProjects.forEach(function(project) { var href = project.path ? url_for(project.path): (project.project_url || '#'); %>
    <li>
      <a href="<%= href %>">
        <% if (project.password) { %>
        <%- partial('partial/lock') %>
        <% } %>
        <span><%= project.title %></span>
      </a>
    </li>
    <% }); %>
  </ul>
</div>
<% } %>
<% if (theme.sidebar?.palette_selector?.enabled) { %>
<%
  var palettes = palette_list ? palette_list() : [],
    defaultKey = (
        theme.sidebar?.palette_selector && theme.sidebar.palette_selector?.default
    ) ? theme.sidebar.palette_selector.default : 'abyssal-blue',
    hasDefault = palettes.some(function (p) { return p.key === defaultKey; });
  if (!hasDefault && palettes.length) {
    defaultKey = palettes[0].key;
  }
%>
<div class="sidebar-section">
  <h3>Palette</h3>
  <div class="palette-switcher" x-data="paletteSwitcher(<%= JSON.stringify(palettes) %>, '<%= defaultKey %>')">
    <select id="palette-select" x-model="currentPalette">
      <template x-for="p in palettes" :key="p.key">
        <option :value="p.key" x-text="(p.name || p.key || p.file) + (p.mode === 'light' ? ' (Light)' : '')" :selected="currentPalette === p.key"></option>
      </template>
    </select>
  </div>
</div>
<script src="<%= url_for('/js/palette-switcher.js') %>"></script>
<% } %>